<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–í–∏—à–ª–∏—Å—Ç</title>
  <link rel="icon" href="data:,">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs" type="module"></script>
  <script>
    function loadEruda(){try{var e=document.createElement('script');e.src='https://cdn.jsdelivr.net/npm/eruda';e.onload=function(){eruda.init();};document.head.appendChild(e);}catch(x){}}
    if(/#eruda/.test(location.hash))loadEruda();
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap&subset=cyrillic,latin" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Splash screen with Logo Animation -->
  <div class="splash-screen" id="splashScreen">
    <dotlottie-player src="Loader.lottie" autoplay loop class="splash-lottie"></dotlottie-player>
  </div>

  <!-- Animated background blobs -->
  <div class="bg-blobs">
    <div class="bg-blob-1"></div>
    <div class="bg-blob-2"></div>
    <div class="bg-blob-3"></div>
  </div>

  <div class="app-shell">
    <header class="app-header" id="mainHeader">
      <img src="logo-main.png?v=2" alt="I Want That So Bad" class="app-logo">
    </header>

    <div class="action-buttons" id="actionButtons">
      <button type="button" class="action-btn add-wish" id="addWishQuickBtn" data-i18n-title="btn_add_wish_title" title="–ù–æ–≤–∞—è —à—Ç—É–∫–∞">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      </button>
      <button type="button" class="action-btn photo" id="addByPhotoBtn" data-i18n-title="btn_add_photo_title" title="–ü–æ —Ñ–æ—Ç–æ—á–∫–µ">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
      </button>
      <button type="button" class="action-btn link" id="addByLinkBtn" data-i18n-title="btn_add_link_title" title="–ü–æ –ª–∏–Ω–∫—É">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>
      </button>
    </div>
    <input type="file" id="addByPhotoInput" accept="image/*" capture="environment" style="display:none">

    <div class="container">
    <div id="content">
      <div class="main-buttons">
        <button class="btn" data-nav="manageWishlists" onclick="window.__nav&&window.__nav('manageWishlists')">–í–∏—à–ª–∏—Å—Ç—ã</button>
        <button class="btn btn-secondary" data-nav="manageCategories" onclick="window.__nav&&window.__nav('manageCategories')">–¢–µ–≥–∏</button>
        <button class="btn btn-secondary" data-nav="manageWishes" onclick="window.__nav&&window.__nav('manageWishes')">–ñ–µ–ª–∞–Ω–∏—è</button>
      </div>
      <h3 class="section-title">Live Feed</h3>
      <div class="recent-list"><p style="color:#999;font-size:0.85rem;font-weight:700;text-transform:uppercase;" data-i18n="feed_loading">–°–µ–∫—É–Ω–¥—É...</p></div>
    </div>
    </div>
  </div>

  <nav class="tab-bar" id="tabBar">
    <button type="button" class="tab-item" data-nav="main" id="tabHome" aria-label="–î–æ–º–æ–π">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
      <span data-i18n="nav_home">–ì–ª–∞–≤–Ω–∞—è</span>
    </button>
    <button type="button" class="tab-item" data-nav="manageWishlists" id="tabWishlists" aria-label="–í–∏—à–ª–∏—Å—Ç—ã">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg>
      <span data-i18n="nav_wishlists">–ú–æ–∏ –ª–∏—Å—Ç—ã</span>
    </button>
    <button type="button" class="tab-item" data-nav="manageCategories" id="tabTags" aria-label="–¢–µ–≥–∏">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/></svg>
      <span data-i18n="nav_tags">–õ–µ–π–±–ª—ã</span>
    </button>
    <button type="button" class="tab-item" data-nav="manageWishes" id="tabWishes" aria-label="–ñ–µ–ª–∞–Ω–∏—è">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/></svg>
      <span data-i18n="nav_wishes">–ñ–µ–ª–∞–Ω–∏—è</span>
    </button>
  </nav>

  <div class="analysis-overlay" id="analysisOverlay">
    <div class="css-loader"></div>
    <span id="analysisOverlayText" data-i18n="overlay_analyzing_image">–°–º–æ—Ç—Ä–∏–º —Ñ–æ—Ç–æ...</span>
  </div>

  <!-- Wish modal -->
  <div class="modal-overlay" id="wishModal">
    <div class="modal">
      <h2 id="wishModalTitle" data-i18n="modal_add_wish">–ù–æ–≤–∞—è —à—Ç—É–∫–∞</h2>
      <form id="wishForm">
        <input type="hidden" id="wishId">
        <div class="form-group">
          <label><span class="required">*</span> <span data-i18n="wish_image_label_text">–ö–∞—Ä—Ç–∏–Ω–∫–∞</span></label>
          <div class="img-upload" id="imgUpload">
            <input type="file" id="wishImage" accept="image/*" capture="environment">
            <span id="imgUploadText" data-i18n="wish_image_placeholder">–¢–∞–ø–Ω–∏ –∏–ª–∏ –ø–µ—Ä–µ—Ç—è–Ω–∏ —Ñ–æ—Ç–æ</span>
            <img id="imgPreview" class="img-preview" style="display:none;" alt="">
          </div>
          <div id="imgError" class="error-msg" style="display:none;"></div>
        </div>
        <div class="form-group">
          <label><span class="required">*</span> <span data-i18n="wish_name_label_text">–ù–∞–∑–≤–∞–Ω–∏–µ</span> <span id="nameCounter">0/100</span></label>
          <input type="text" id="wishName" maxlength="100" data-i18n-placeholder="wish_name_placeholder">
          <div id="nameError" class="error-msg" style="display:none;"></div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label data-i18n="wish_price_label">–ü—Ä–∞–π—Å</label>
            <input type="number" id="wishPrice" min="0" max="9999999" step="0.01" placeholder="0">
            <div id="priceError" class="error-msg" style="display:none;"></div>
          </div>
          <div class="form-group">
            <label data-i18n="wish_currency_label">–ß–µ–º –ø–ª–∞—Ç–∏–º</label>
            <select id="wishCurrency">
              <option value="">‚Äî</option>
              <option value="‚Ç¨">‚Ç¨</option>
              <option value="$">$</option>
              <option value="Br">Br</option>
              <option value="‚ÇΩ">‚ÇΩ</option>
              <option value="‚Ç∏">‚Ç∏</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label data-i18n="wish_size_label">–†–∞–∑–º–µ—Ä</label>
          <input type="text" id="wishSize" placeholder="M, 42, XL">
          <div id="sizeError" class="error-msg" style="display:none;"></div>
        </div>
        <div class="form-group">
          <label data-i18n="wish_link_label">–°—Å—ã–ª–∫–∞</label>
          <input type="url" id="wishLink" data-i18n-placeholder="wish_link_placeholder">
          <div id="linkError" class="error-msg" style="display:none;"></div>
        </div>
        <div class="form-group">
          <label><span data-i18n="wish_comment_label">–ó–∞–º–µ—Ç–∫–∞</span> <span id="commentCounter">0/500</span></label>
          <textarea id="wishComment" maxlength="500" data-i18n-placeholder="wish_comment_placeholder"></textarea>
        </div>
        <div class="form-group">
          <label data-i18n="wish_category_label">–õ–µ–π–±–ª</label>
          <select id="wishCategory">
            <option value="" data-i18n="wish_category_none">–ë–µ–∑ –ª–µ–π–±–ª–∞</option>
          </select>
        </div>
        <div class="form-group">
          <label data-i18n="wish_wl_label">–ö—É–¥–∞ –¥–æ–±–∞–≤–∏—Ç—å</label>
          <div class="multiselect-wrap" id="wishWishlistSelect"></div>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="wishCancel" data-i18n="btn_cancel">–û—Ç–º–µ–Ω–∞</button>
          <button type="submit" class="btn" data-i18n="btn_save">–ì–æ—Ç–æ–≤–æ</button>
        </div>
        <div id="wishDeleteSection" style="display:none;margin-top:16px;padding-top:16px;border-top:2px solid #000;">
          <button type="button" class="btn" id="wishDeleteBtn" style="width:100%;background:#FF0000;color:#fff;" data-i18n="btn_delete_wish">üóë –£–¥–∞–ª–∏—Ç—å</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Categories modal -->
  <div class="modal-overlay" id="catsModal">
    <div class="modal">
      <h2>–ü—Ä–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
      <p style="color:var(--text-secondary);font-size:0.9rem;margin-bottom:16px;">
        –£–¥–∞–ª—è–π –Ω–µ–Ω—É–∂–Ω—ã–µ –∏ –¥–æ–±–∞–≤–ª—è–π —Å–≤–æ–∏. –ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–æ–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.
      </p>
      <div class="cat-list" id="catList"></div>
      <div class="cat-add">
        <input type="text" id="newCatName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
        <button type="button" class="btn" id="addCatBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>
      <div class="form-actions" style="margin-top:20px;">
        <button type="button" class="btn btn-secondary" id="catsClose" data-i18n="btn_close">–ü–æ–Ω—è—Ç–Ω–æ</button>
      </div>
    </div>
  </div>

  <!-- Wishlists modal -->
  <div class="modal-overlay" id="wlModal">
    <div class="modal">
      <h2>–ü—Ä–∞–≤–∏—Ç—å –≤–∏—à–ª–∏—Å—Ç—ã</h2>
      <p style="color:var(--text-secondary);font-size:0.9rem;margin-bottom:16px;">
        –í–∏—à–ª–∏—Å—Ç ‚Äî –ø–∞–ø–∫–∞ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –∂–µ–ª–∞–Ω–∏–π. –î–æ–±–∞–≤–ª—è–π, —É–¥–∞–ª—è–π, –ø–µ—Ä–µ–Ω–æ—Å–∏ –∫–∞—Ä—Ç–æ—á–∫–∏.
      </p>
      <div class="cat-list" id="wlList"></div>
      <div style="margin-top:16px;" id="wlAddForm">
        <div class="form-group">
          <label><span class="required">*</span> –ù–∞–∑–≤–∞–Ω–∏–µ</label>
          <input type="text" id="newWlName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏—à–ª–∏—Å—Ç–∞">
        </div>
        <div class="form-group">
          <label>–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å</label>
          <select id="newWlPrivacy">
            <option value="private">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π ‚Äî —Ç–æ–ª—å–∫–æ –≤—ã</option>
            <option value="public">–ü—É–±–ª–∏—á–Ω—ã–π ‚Äî –ª—é–±–æ–π –ø–æ —Å—Å—ã–ª–∫–µ –º–æ–∂–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å –∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</option>
            <option value="shared">–°–æ–≤–º–µ—Å—Ç–Ω—ã–π ‚Äî —Å–æ–∞–≤—Ç–æ—Ä—ã –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é</option>
          </select>
        </div>
        <div class="form-group">
          <label>–ö–∞—Ä—Ç–∏–Ω–∫–∞</label>
          <div class="img-upload wl-add-img" id="wlImgUpload">
            <input type="file" id="wlImage" accept="image/*">
            <span id="wlImgText">–î–æ–±–∞–≤–∏—Ç—å –æ–±–ª–æ–∂–∫—É (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
            <img id="wlImgPreview" class="img-preview" style="display:none;max-height:120px;" alt="">
          </div>
        </div>
        <button type="button" class="btn" id="addWlBtn">–î–æ–±–∞–≤–∏—Ç—å –≤–∏—à–ª–∏—Å—Ç</button>
      </div>
      <div id="wlEditForm" style="display:none;">
        <div class="form-group">
          <label><span class="required">*</span> –ù–∞–∑–≤–∞–Ω–∏–µ</label>
          <input type="text" id="editWlName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≤–∏—à–ª–∏—Å—Ç–∞">
        </div>
        <div class="form-group">
          <label>–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å</label>
          <select id="editWlPrivacy">
            <option value="private">–ü—Ä–∏–≤–∞—Ç–Ω—ã–π</option>
            <option value="public">–ü—É–±–ª–∏—á–Ω—ã–π</option>
            <option value="shared">–°–æ–≤–º–µ—Å—Ç–Ω—ã–π</option>
          </select>
        </div>
        <div class="form-group">
          <label>–ö–∞—Ä—Ç–∏–Ω–∫–∞</label>
          <div class="img-upload wl-add-img" id="wlImgUploadEdit">
            <input type="file" id="wlImageEdit" accept="image/*">
            <span id="wlImgTextEdit">–û–±–ª–æ–∂–∫–∞</span>
            <img id="wlImgPreviewEdit" class="img-preview" style="display:none;max-height:120px;" alt="">
          </div>
        </div>
        <div id="wlEditFormExtras"></div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="editWlCancel">–û—Ç–º–µ–Ω–∞</button>
          <button type="button" class="btn" id="editWlSave">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
      <div class="form-actions" style="margin-top:20px;">
        <button type="button" class="btn btn-secondary" id="wlClose" data-i18n="btn_close">–ü–æ–Ω—è—Ç–Ω–æ</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="shareWlModal">
    <div class="modal">
      <h2 data-i18n="share_wl_title">–®–µ—Ä–∏—Ç—å –ª–∏—Å—Ç</h2>
      <p style="color:var(--text-secondary);font-size:0.9rem;margin-bottom:12px;" data-i18n="share_wl_desc">–ö–∏–Ω—å —Å—Å—ã–ª–∫—É –≤ –¢–µ–ª–µ–≥—É ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –±–æ—Ç–µ. –ö—Ç–æ –ø–µ—Ä–µ–π–¥—ë—Ç, —É–≤–∏–¥–∏—Ç –ª–∏—Å—Ç –∏ —Å–º–æ–∂–µ—Ç –∑–∞–±—É–∫–∞—Ç—å —Ö–æ—Ç–µ–ª–∫–∏.</p>
      <div class="share-link" id="shareWlLink" style="word-break:break-all;padding:12px;background:var(--bg-card);border-radius:8px;font-size:0.85rem;"></div>
      <p id="shareWlHint" style="display:none;color:var(--accent);font-size:0.8rem;margin-top:8px;">–ß—Ç–æ–±—ã —Å—Å—ã–ª–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–ª–∞—Å—å –≤ –±–æ—Ç–µ, —É–∫–∞–∂–∏ <code>wantthat_bot</code> –∏ <code>wantthat</code> –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞.</p>
      <div class="form-actions" style="margin-top:16px;">
        <button type="button" class="btn btn-secondary" id="shareWlClose" data-i18n="btn_close">–ü–æ–Ω—è—Ç–Ω–æ</button>
        <button type="button" class="btn" id="shareWlCopy" data-i18n="btn_copy">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="shareWelcomeModal">
    <div class="modal">
      <h2 data-i18n="share_wl_title">–®–µ—Ä–∏—Ç—å –ª–∏—Å—Ç</h2>
      <p id="shareWelcomeText" style="color:#222;font-size:0.95rem;margin-bottom:20px;"></p>
      <button type="button" class="btn" id="shareWelcomeOk" data-i18n="btn_got_it">–û–∫–µ–π</button>
    </div>
  </div>

  <!-- Read-only wish view -->
  <div class="modal-overlay" id="wishViewModal">
    <div class="modal" style="padding:0;overflow:hidden;background:#F0F0F0;">
      <div style="position:relative;">
        <img id="wishViewImgEl" style="width:100%;aspect-ratio:1;max-height:220px;object-fit:cover;display:none;" alt="">
        <button type="button" id="wishViewEditBtn" style="display:none;position:absolute;top:10px;right:10px;width:40px;height:40px;border-radius:50%;border:2px solid #000;background:rgba(255,255,255,0.92);color:#000;font-size:1.1rem;cursor:pointer;box-shadow:3px 3px 0 0 rgba(0,0,0,0.5);z-index:2;align-items:center;justify-content:center;">‚úèÔ∏è</button>
      </div>
      <div style="padding:20px 20px 16px;">
        <h2 id="wishViewName" style="font-size:1.1rem;font-weight:900;text-transform:uppercase;margin-bottom:12px;color:#000;letter-spacing:-0.01em;word-break:break-word;"></h2>
        <div id="wishViewMeta" style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:14px;"></div>
        <div id="wishViewLink" style="display:none;margin-bottom:10px;"></div>
        <div id="wishViewComment" style="display:none;font-size:0.88rem;color:#333;border-left:3px solid #FF00FF;padding-left:10px;margin-bottom:14px;line-height:1.5;"></div>
        <button type="button" class="btn btn-secondary" id="wishViewClose" style="width:100%;" data-i18n="btn_close">–ü–æ–Ω—è—Ç–Ω–æ</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="inviteConsentModal">
    <div class="modal">
      <h2 data-i18n="invite_modal_title">–ò–Ω–≤–∞–π—Ç</h2>
      <p id="inviteConsentText" style="color:#222;font-size:0.95rem;margin-bottom:20px;"></p>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" id="inviteConsentDecline" data-i18n="btn_decline">–ù–µ, —Å–ø—Å</button>
        <button type="button" class="btn" id="inviteConsentAccept" data-i18n="btn_accept">–ü–æ–≥–Ω–∞–ª–∏</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" id="inviteWlModal">
    <div class="modal">
      <h2 data-i18n="invite_wl_title">–ü–æ–∑–≤–∞—Ç—å —Å–æ–∞–≤—Ç–æ—Ä–∞</h2>
      <p style="color:var(--text-secondary);font-size:0.9rem;margin-bottom:12px;" data-i18n="invite_wl_desc">–ö–∏–Ω—å —Å—Å—ã–ª–∫—É –≤ –¢–µ–ª–µ–≥—É ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –±–æ—Ç–µ, —á–µ–ª–æ–≤–µ–∫ —Å—Ç–∞–Ω–µ—Ç —Å–æ–∞–≤—Ç–æ—Ä–æ–º –∏ —Å–º–æ–∂–µ—Ç —Ä–µ–¥–∞—á–∏—Ç—å –ª–∏—Å—Ç.</p>
      <div class="share-link" id="inviteWlLink" style="word-break:break-all;padding:12px;background:var(--bg-card);border-radius:8px;font-size:0.85rem;"></div>
      <p id="inviteWlHint" style="display:none;color:var(--accent);font-size:0.8rem;margin-top:8px;">–ß—Ç–æ–±—ã —Å—Å—ã–ª–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–ª–∞—Å—å –≤ –±–æ—Ç–µ, —É–∫–∞–∂–∏ <code>TELEGRAM_BOT</code> –∏ <code>TELEGRAM_APP</code> –≤ –Ω–∞—á–∞–ª–µ —Å–∫—Ä–∏–ø—Ç–∞.</p>
      <div class="form-actions" style="margin-top:16px;">
        <button type="button" class="btn btn-secondary" id="inviteWlClose" data-i18n="btn_close">–ü–æ–Ω—è—Ç–Ω–æ</button>
        <button type="button" class="btn" id="inviteWlCopy" data-i18n="btn_copy">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
